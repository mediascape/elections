<dom-module id="x-media" >



<template>
	<style >



	#container {
	background-color: #0A2533;
	padding: 5px;
	height:100%;
}
	@media (max-width:350px){
		video{width:100%;height:100%;}



	}
	@media (min-width:351px){
		video{width:100%;height:100%;}


	}

</style>

<div  id="container"  class='template-all-layouts'>
	<video id={{ida}} preload mute src></video>
</div>

</template>
</dom-module>
<!--<script src="//ajax.googleapis.com/ajax/libs/jqueryui/1.11.2/jquery-ui.min.js"></script>-->
 <script>
Polymer({
	is:'x-media',
  behaviors:[ComponentQueryBehavior,ComponentStatusBehavior],
	hostAttributes:{
		skew:0.0,
		sm:null,
		l:''
	},
	properties:{
		file:{
			 type:String,

		},
			ismuted:{
				type:String,
				value:'false'
			},
			customCmd:{
	        type:String,
	        value:'',
	        observer: 'customCmdReceived'
	    },
			ida:String
	},

	ready: function() {
		var _this = this;
		document.addEventListener ('motion-ready',this.smReady.bind(this));
		this.ida = "player1"+this.id;
	},
	muteChanged:function(){
		 if (this.mute === true){

		}
	},
	smReady:function(e){
		var _this = this;
		this.sm = mediascape.AdaptationToolkit.SharedMotion();
		var id = 0;
		if (navigator.appVersion.indexOf("MK12")!=-1)
		setTimeout(function(){
			if(_this.id.indexOf("video")>-1){

				video=document.createElement('video');
				video.id="player1"+_this.id;
				video.style.width='100%';
				video.style.height='100%';
				video.style.backgroundColor='#173F56';

				//if (this.show)
				video.src=_this.file;
				if(_this.ismuted==="true"){
					video.muted=true;
				}
				video.preload = "auto";
				_this.$.container.appendChild(video);
				video.addEventListener('ended', function () {
						_this.restart();
				});
			}

 			_this.sm.addVideo (_this.querySelector('video'),id,_this.skew);
			var cmpStatus = mediascape.AdaptationToolkit.componentManager.core.getComoponentsToShow();
			if (cmpStatus) mediascape.AdaptationToolkit.Adaptation.UIAdaptation.onComponentsChange(cmpStatus);
		},10000);
		else
		setTimeout(function(){
			 var video = _this.querySelector('video')
			// video.src=_this.file;
			_this.sm.addVideo (video,id,_this.skew);
		//	var cmpStatus = mediascape.AdaptationToolkit.componentManager.core.getComoponentsToShow();
		//	if (cmpStatus) mediascape.AdaptationToolkit.Adaptation.UIAdaptation.onComponentsChange(cmpStatus);
	},4000);
  },
	play:function(){
		if (this.sm) this.sm.mapp.motions.shared.update(null, 1);
	},

  start_volumeChanged:function(currentVol){
		this.$.container.children[0].volume=parseInt(currentVol);
	},

	mutePlayer:function(){
		this.$.container.children[0].muted=true;
	},
	soundPlayer:function(){
		this.$.container.children[0].muted=false;
	},
	restart: function (){
		this.sm.mapp.motions.shared.update(0, 1);
	},
	customCmdReceived: function(data){
			if(data==='mutePlayer'){
				this.mutePlayer();
			}
			else if(data==='soundPlayer'){
				this.soundPlayer();
			}
			else if(data==='offSound'){

			}
			else if(data==='onSound'){

			}
	},
	unload:function(){
		 var video = this.querySelector('video')
		 video.src ="";

	},
	load:function(){
	     var video = this.querySelector('video')
			 video.src = this.file;
	}
});
 </script>
